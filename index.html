<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>个人所得税</title>

    <!-- PWA 相关配置 -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="个人所得税">
    <link rel="apple-touch-icon" href="icon.png">
    <link rel="manifest" href="manifest.json">

    <style>
        /* --- 全局重置与基础样式 --- */
        :root {
            --primary-blue: #3A80E8;
            --light-blue: #64B5F6;
            --text-dark: #333;
            --text-light: #666;
            --text-lighter: #999;
            --bg-gray: #f4f6f9;
            --safe-area-inset-bottom: env(safe-area-inset-bottom, 0);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", "Segoe UI", Roboto, Arial, sans-serif; background-color: var(--bg-gray); color: var(--text-dark); -webkit-font-smoothing: antialiased; padding-bottom: calc(65px + var(--safe-area-inset-bottom)); }
        .page { display: none; min-height: 100vh; background-color: var(--bg-gray); }
        a { text-decoration: none; color: inherit; }

        /* --- 认证遮罩层 --- */
        #auth-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--bg-gray); z-index: 2000; display: flex; justify-content: center; align-items: center; text-align: center; color: var(--text-light); font-size: 18px; }
        #auth-overlay .message { padding: 20px; }

        /* --- 视觉增强: 模拟状态栏 --- */
        .status-bar { height: 44px; display: flex; justify-content: space-between; align-items: center; padding: 0 15px; font-size: 14px; font-weight: 500; position: sticky; top: 0; z-index: 101; }
        .status-bar.on-blue-bg { color: white; }
        .status-bar .time { position: absolute; left: 50%; transform: translateX(-50%); }
        .status-bar .right-icons { display: flex; align-items: center; gap: 5px; }

        /* --- 视觉增强: SVG图标 --- */
        .icon { display: inline-block; width: 1em; height: 1em; background-color: currentColor; mask-repeat: no-repeat; mask-size: contain; mask-position: center; }
        .icon-search { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>'); }
        .icon-scan { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 7V5a2 2 0 0 1 2-2h2M17 3h2a2 2 0 0 1 2 2v2M21 17v2a2 2 0 0 1-2 2h-2M7 21H5a2 2 0 0 1-2-2v-2M7 12h10"></path></svg>'); }
        .icon-bell { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>'); color: #f57c00; }
        .icon-fire { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="red" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11.448 20.252a12.11 12.11 0 0 0 5.426-8.995c.03-1.043.168-2.272.168-2.272s-3.212 1.37-4.225 3.376c-1.011 2.004-1.488 4.39-1.488 4.39s.117-1.42.119-1.42c.002-.002 4.414-6.27 1.848-11.232C11.733 1.135 6.26 3.66 6.26 3.66s3.83 5.922-1.23 10.983c-2.34 2.34-1.39 4.353-1.39 4.353s2.131-1.63 4.166-.37c2.036 1.26 2.092 1.63 2.092 1.63s1.247.37 1.55.096z"/></svg>'); }
        .icon-users { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>'); }
        .icon-arrow-right { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>'); }
        
        /* --- 首页详细样式 --- */
        #page-home .home-header-bg { background: linear-gradient(to bottom, #d6eaff, var(--bg-gray) 60%); padding: 0 15px; }
        .search-bar { display: flex; align-items: center; background-color: #fff; border-radius: 99px; padding: 10px 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
        .search-bar .icon-search { color: var(--text-lighter); font-size: 18px; }
        .search-bar input { border: none; outline: none; flex-grow: 1; font-size: 14px; margin: 0 10px; background: transparent; }
        .search-bar .icon-scan { color: var(--text-dark); font-size: 20px; }
        
        .notification-bar { background-color: #eaf3fe; color: var(--primary-blue); padding: 10px 15px; border-radius: 8px; margin-top: 15px; font-size: 14px; display: flex; align-items: center; }
        .notification-bar .icon-bell { margin-right: 10px; font-size: 16px; }

        .main-banner { background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="%2364b5f6"/><stop offset="100%" stop-color="%233a80e8"/></linearGradient></defs><rect width="100%" height="100%" fill="url(%23g)"/></svg>'), linear-gradient(135deg, #64b5f6, var(--primary-blue)); background-size: cover; color: white; padding: 20px 15px; border-radius: 12px; margin-top: 15px; box-shadow: 0 4px 12px rgba(58, 128, 232, 0.3); position: relative; overflow: hidden; }
        .banner-title { font-size: 20px; font-weight: bold; margin-bottom: 5px; }
        .banner-subtitle { font-size: 13px; opacity: 0.9; margin-bottom: 20px; max-width: 65%; }
        .banner-action { background-color: #5d9cec; color: white; border: none; padding: 12px 30px; border-radius: 99px; font-weight: bold; cursor: pointer; font-size: 16px; }
        .banner-link { position: absolute; top: 15px; right: 15px; font-size: 13px; background: rgba(255,255,255,0.2); padding: 4px 8px; border-radius: 99px; }
        .banner-image { content: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g transform="translate(0, -5)"><path d="M50 30 C 45 20, 35 20, 30 30 C 20 50, 40 55, 50 60 C 60 55, 80 50, 70 30 C 65 20, 55 20, 50 30 Z" fill="%23E0E0E0"/><path d="M50,60 L50,85" stroke="%23BDBDBD" stroke-width="8" stroke-linecap="round"/><path d="M50,70 L30,80" stroke="%23BDBDBD" stroke-width="6" stroke-linecap="round"/><path d="M50,70 L70,80" stroke="%23BDBDBD" stroke-width="6" stroke-linecap="round"/><circle cx="50" cy="15" r="10" fill="%23FFF"/><rect x="40" y="22" width="20" height="8" fill="%23E0E0E0" rx="2"/></g></svg>'); position: absolute; bottom: 5px; right: 10px; width: 90px; height: 90px; opacity: 0.8; }

        .home-content { padding: 15px; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin: 20px 0 15px; }
        .section-header h3 { font-size: 18px; font-weight: bold; margin: 0; }
        
        .recommendation-card { background: linear-gradient(135deg, var(--light-blue), var(--primary-blue)); padding: 20px; border-radius: 12px; margin-bottom: 20px; color: white; }
        .rec-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .rec-title { display: flex; align-items: center; font-size: 17px; font-weight: bold; }
        .rec-title .icon-fire { margin-right: 8px; font-size: 20px; }
        .rec-policy { font-size: 13px; opacity: 0.9; }
        .rec-info { font-size: 15px; margin-bottom: 20px; }
        .rec-button-container { display: flex; align-items: center; background-color: white; border-radius: 99px; padding: 5px; }
        .rec-button-info { display: flex; align-items: center; color: var(--text-light); font-size: 13px; padding: 0 15px; }
        .rec-button-info .icon-users { font-size: 20px; margin-right: 8px; color: var(--primary-blue); }
        .rec-button-divider { width: 1px; height: 15px; background-color: #e0e0e0; }
        .rec-button-action { flex-grow: 1; text-align: center; color: var(--primary-blue); font-weight: bold; padding: 8px 10px; }

        .service-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .service-item { display: flex; flex-direction: column; align-items: center; text-align: center; background-color: #fff; border-radius: 12px; padding: 15px 5px; }
        .service-icon-wrapper { width: 48px; height: 48px; border-radius: 50%; display: flex; justify-content: center; align-items: center; margin-bottom: 10px; }
        .service-icon-wrapper .icon { font-size: 24px; color: white; }
        .service-text { font-size: 13px; color: var(--text-dark); margin-bottom: 5px; }
        .service-action { font-size: 12px; color: var(--text-lighter); }
        .icon-bg-blue { background-color: #42a5f5; }
        .icon-bg-purple { background-color: #ab47bc; }
        .icon-bg-green { background-color: #66bb6a; }
        .icon-bg-gray { background-color: #a0aec0; }
        .icon-service-doc { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line></svg>'); }
        .icon-service-wallet { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 12V8a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-4"></path><path d="M20 12H8m12-4a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h1z"></path></svg>'); }
        .icon-service-receipt { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 10V4H2v16h8m8 0v-6h-6v6h6zm-3-3h.01"></path></svg>'); }
        .icon-service-grid { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>'); }
        
        /* --- “我的”页面详细样式 --- */
        .profile-header-bg { background: linear-gradient(to bottom, var(--primary-blue) 0%, var(--light-blue) 60%, var(--bg-gray) 100%); height: 210px; position: absolute; top: 0; left: 0; width: 100%; z-index: 1; }
        #page-profile .profile-content { position: relative; z-index: 2; padding: 15px; }
        
        .profile-card { margin-top: 50px; background: linear-gradient(100deg, #fce1c4, #f8c3a1); border-radius: 12px; padding: 15px; display: flex; align-items: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .profile-avatar { width: 64px; height: 64px; border-radius: 50%; background-color: #fff; margin-right: 15px; border: 3px solid white; display: flex; justify-content: center; align-items: center; }
        .profile-avatar img { width: 100%; height: 100%; border-radius: 50%; }
        .profile-details { flex-grow: 1; }
        .profile-name { font-size: 20px; font-weight: bold; margin-bottom: 5px; color: #5d4037; }
        .profile-taxid { font-size: 13px; color: #8d6e63; }
        .profile-link { background-color: #f4a261; color: #fff; padding: 6px 12px; border-radius: 99px; font-size: 12px; font-weight: 500; }

        .quick-access-cards { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-top: 20px; }
        .quick-access-item { background-color: #fff; padding: 15px; border-radius: 12px; text-align: center; }
        .quick-access-icon { font-size: 24px; margin-bottom: 8px; }
        .qa-icon-home { color: #ff7043; }
        .qa-icon-job { color: #ffca28; }
        .qa-icon-card { color: #66bb6a; }
        .quick-access-label { font-size: 14px; color: var(--text-dark); margin-bottom: 4px; }
        .quick-access-value { font-size: 12px; color: var(--text-lighter); }
        .value-add { color: var(--primary-blue); font-weight: 500; }

        .settings-list { background-color: white; border-radius: 12px; margin: 20px 0; }
        .settings-item { display: flex; align-items: center; padding: 16px 15px; border-bottom: 1px solid #f0f0f0; }
        .settings-item:last-child { border-bottom: none; }
        .settings-icon { font-size: 20px; margin-right: 15px; color: #555; }
        .settings-label { flex-grow: 1; font-size: 16px; }
        .settings-badge { width: 8px; height: 8px; background-color: red; border-radius: 50%; margin-right: 8px; }
        .icon-heart { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>'); }
        .icon-building { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M16 13V3H8v18h11v-8h-3zM4 21V9l-2 2v10h2z"/><path d="M10 5h4v2h-4zM10 9h4v2h-4zM10 13h4v2h-4z"/></svg>'); }
        .icon-shield { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-1 16l-4-4 1.41-1.41L11 14.17l6.59-6.59L19 9l-8 8z"/></svg>'); }
        .icon-help { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/></svg>'); }
        .icon-chat { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg>'); }
        .icon-info { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>'); }
        
        .logout-button { width: 100%; padding: 15px; background-color: white; color: var(--text-dark); border: none; border-radius: 12px; font-size: 16px; text-align: center; cursor: pointer; }

        /* --- 底部导航栏 --- */
        #bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background-color: #ffffff; box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05); display: none; z-index: 100; border-top: 1px solid #f0f0f0; }
        .nav-container { display: flex; justify-content: space-around; padding: 5px 0 calc(5px + var(--safe-area-inset-bottom)); }
        .nav-item { flex: 1; text-align: center; color: var(--text-light); cursor: pointer; font-size: 11px; }
        .nav-item.active { color: var(--primary-blue); }
        .nav-icon { font-size: 24px; position: relative; margin: 0 auto 3px; width: 24px; }
        .nav-badge { position: absolute; top: -4px; right: -8px; background-color: red; color: white; border-radius: 99px; min-width: 16px; height: 16px; padding: 0 4px; line-height: 16px; font-size: 10px; text-align: center; border: 1px solid white; }
        .icon-nav-home { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>'); }
        .icon-nav-todo { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/></svg>'); }
        .icon-nav-services { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-2 .89-2 2v11c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zM10 4h4v2h-4V4zm10 15H4V8h16v11z"/></svg>'); }
        .icon-nav-messages { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/></svg>'); }
        .icon-nav-profile { mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>'); }

        /* --- 旧页面样式 (兼容性调整) --- */
        #page-query, #page-results { background-color: #fff; }
        .header { display: flex; align-items: center; justify-content: center; position: relative; padding: 15px; background-color: #ffffff; border-bottom: 1px solid #e8e8e8; height: 50px; } 
        .header .back-link { position: absolute; left: 15px; font-size: 24px; color: #333; cursor: pointer; line-height: 1; } 
        .header .title { font-size: 18px; font-weight: bold; } 
        #page-query { background-color: var(--bg-gray); }
        #page-query .container { background-color: #ffffff; margin-top: 10px; } 
        #page-query .main-content { padding: 0 15px; } 
        #page-query .footer { padding: 30px 15px; background-color: var(--bg-gray); } 
        #page-query .query-button { width: 100%; padding: 15px; background-color: var(--primary-blue); color: white; border: none; border-radius: 8px; font-size: 18px; cursor: pointer; }
        #page-results .summary-section { background-color: #fff; border-bottom: 10px solid var(--bg-gray); }
    </style>
</head>
<body>

    <div id="auth-overlay">
        <div class="message">正在验证使用权限...</div>
    </div>
    
    <!-- 页面一：首页 -->
    <div id="page-home" class="page">
        <div class="status-bar">
            <span class="time">11:35</span>
            <div class="right-icons">... 📶 🔋</div>
        </div>
        <div class="home-header-bg">
            <div class="search-bar">
                <i class="icon icon-search"></i>
                <input type="text" placeholder="请输入想要搜索的功能/服务">
                <i class="icon icon-scan"></i>
            </div>
            <div class="notification-bar">
                <i class="icon icon-bell"></i>
                务总局令第57号：《个人所得税综合所得汇算》
            </div>
            <div class="main-banner">
                <div class="banner-title">2024综合所得年度汇算</div>
                <div class="banner-subtitle">已于6月30日结束，逾期办理可能会产生滞纳金，请您尽快申报</div>
                <button class="banner-action">开始申报</button>
                <a href="#" class="banner-link">进入专题页 <i class="icon icon-arrow-right" style="font-size: 0.8em;"></i></a>
                <div class="banner-image"></div>
            </div>
        </div>
        <div class="home-content">
            <div class="section-header">
                <h3>重点服务推荐</h3>
            </div>
            <div class="recommendation-card">
                <div class="rec-header">
                    <div class="rec-title"><i class="icon icon-fire"></i>专项附加扣除</div>
                    <a href="#" class="rec-policy">相关政策 <i class="icon icon-arrow-right" style="font-size: 0.8em;"></i></a>
                </div>
                <p class="rec-info">若符合条件，您可点击下方填报</p>
                <div class="rec-button-container">
                    <div class="rec-button-info"><i class="icon icon-users"></i>超1亿人参与</div>
                    <div class="rec-button-divider"></div>
                    <a href="#" class="rec-button-action">我要填报</a>
                </div>
            </div>
            <div class="service-grid">
                <a href="#" class="service-item">
                    <div class="service-icon-wrapper icon-bg-blue"><i class="icon icon-service-doc"></i></div>
                    <div class="service-text">综合所得年度汇算</div>
                    <div class="service-action">去申报</div>
                </a>
                <a id="nav-to-query" class="service-item">
                    <div class="service-icon-wrapper icon-bg-purple"><i class="icon icon-service-wallet"></i></div>
                    <div class="service-text">收入纳税明细</div>
                    <div class="service-action">去查询</div>
                </a>
                <a href="#" class="service-item">
                    <div class="service-icon-wrapper icon-bg-green"><i class="icon icon-service-receipt"></i></div>
                    <div class="service-text">纳税记录开具</div>
                    <div class="service-action">去开具</div>
                </a>
                <a href="#" class="service-item">
                    <div class="service-icon-wrapper icon-bg-gray"><i class="icon icon-service-grid"></i></div>
                    <div class="service-text">更多功能</div>
                    <div class="service-action">去设置</div>
                </a>
            </div>
        </div>
    </div>

    <!-- 页面二：我的 -->
    <div id="page-profile" class="page">
        <div class="status-bar on-blue-bg">
            <span class="time">11:34</span>
            <div class="right-icons">... 📶 🔋</div>
        </div>
        <div class="profile-header-bg"></div>
        <div class="profile-content">
            <div id="profile-info-trigger" class="profile-card">
                <div class="profile-avatar">
                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48cGF0aCBmaWxsPSIjRkZEN0MwIiBkPSJNMTAwIDBDNDQuOSA4LjUtMTQgNDQuOSAwIDEwMGMwIDU1LjIgNDQuOCAxMDAgMTAwIDEwMCAxMDAgMCAxMDAtODUgMTAwLTEwMFMxNTUuMS04LjUgMTAwIDB6Ii8+PHBhdGggZmlsbD0iI0ZGRkZGRiIgZD0iTTEzNi40IDEyMy44YzMuMi0zLjIgNS4yLTcuNSA1LjItMTIuMiAwLTkuNy03LjgtMTcuNS0xNy41LTE3LjVzLTE3LjUgNy44LTE3LjUgMTcuNWMwIDQuNyAyIDkgNS4yIDEyLjIgNC40IDQuNCAxMS4yIDcuNCAxOC4xIDcuNCAzLjEgMCA2LjEtLjYgOC44LTEuNy0xLjItOS4zLTYuOS0xNy4zLTE0LjYtMjAuNi0xLjgtLjgtMy44LS41LDUuNCAxLjEgMS45IDEuNyAzLjEgNC4xIDMuMSA2LjcgMCAyLjYtMS4yIDUtMy4xIDYuNy0uMi4yLS41LjMtLjcuMy0uNSAwLTEtLjQtMS0xIDAtLjYtMS4xLTEuMS0yLjEtMS4xcy0yLjEgLjUtMi4xIDEuMWMwIC42LS40IDEtMSAxcy0uNy0uMy0uNy0uN2MwLTItLjktMy43LTIuMy01LjFzLTMuMy0yLjItNS4xLTIuMmMtMS44IDAtMy41LjgtNS4xIDIuMi0xLjUgMS41LTIuMyAzLjItMi4zIDUuMSAwIC40LS4zLjctLjcuN3MtMS0uNC0xLTFjMC0uNi0xLTEuMS0yLjEtMS4xcy0yLjEgLjUtMi4xIDEuMWMwIC42LS40IDEtMSAxLS4zIDAtLjYtLjEtLjctLjMtMS45LTEuNy0zLjEtNC4xLTMuMSA2LjcgMCAyLjYgMS4yIDUgMy4xIDYuNyAxLjggMS4xIDMuNiAxLjQgNS40IDEuMS03LjcgMy4yLTEzLjQgMTEuMy0xNC42IDIwLjYgMi43IDEuMSA1LjcgMS43IDguOCAxLjcgNi45IDAgMTMuNy0zIDE4LjEtNy40eiIvPjxwYXRoIGZpbGw9IiMzNzQwNTIiIGQ9Ik0xMjEuNCA3MC4xYy0yLjEtMS44LTYtMy4yLTExLjQtMy4ycy05LjMgMS40LTExLjQgMy4yYy0xLjIgMS0xLjkgMi41LTEuOSAzLjhzLjcgMi44IDEuOSAzLjhjMi4xIDEuOCA2IDMuMiAxMS40IDMuMnM5LjMtMS40IDExLjQtMy4yYzIuMy0yLjIgMi4zLTUuNSAwLTcuNnptLTM0LjkgMTQuNWMtMi4zLTIuMi0yLjMtNS41IDAtNy42IDIuMS0xLjggNi0zLjIgMTEuNC0zLjJzOS4zIDEuNCAxMS40IDMuMmMxLjIgMSAxLjkgMi41IDEuOSAzLjggMCAxLjQtLjcgMi44LTEuOSAzLjhzLTYgMy4yLTExLjQgMy4yczAtdi0xMS40LTMuMnptMzQuOS0uMWMtMS4zLTEuMS0zLjQtMi02LTJoLTEwLjJjLTEuMyAwLTIuNy4xLTMuOS40LjIgMy4yIDEuNSA2LjEgMy45IDguMiAyLjMgMi4yIDUuNSAyLjIgNy42IDAgMi4zLTIuMiAyLjMtNS41IDAtNy42em0tNDIuMy0yNy41YzQuNC00LjQgMTEuNC00LjQgMTUuOCAwIDQuNCA0LjQgNC40IDExLjQgMCAxNS44LTQuNCA0LjQtMTEuNCA0LjQtMTUuOCAwLTQuNC00LjQtNC40LTExLjQtLjEtMTUuOHptNDUuNyAwYzQuNC00LjQgMTEuNC00LjQgMTUuOCAwIDQuNCA0LjQgNC40IDExLjQgMCAxNS44LTQuNCA0LjQtMTEuNCA0LjQtMTUuOCAwcy00LjQtMTEuNC0uMS0xNS44ek0xMzYuNCAxMDguMnYtNy43YzAtMi45LTEuMi01LjYtMy4yLTcuNWgtMjAuNWMtMi4xIDEuOS0zLjIgNC42LTMuMiA3LjV2Ny43YzAgMi4xIDEuNyAzLjggMy44IDMuOGg3LjFjMS43IDMgNC4xIDQuOSA2LjggNC45cy01LjEtMS45LTYuOC00LjloNy4xYzI-.Mi4xIDMuOC0xLjcgMy44LTMuOHoiLz48L3N2Zz4=" alt="avatar">
                </div>
                <div class="profile-details">
                    <div id="display-name" class="profile-name">某某</div>
                    <div id="display-taxid" class="profile-taxid">纳税人识别号 9****************Y</div>
                </div>
                <a href="#" class="profile-link">个人信息 <i class="icon icon-arrow-right" style="font-size: 0.8em;"></i></a>
            </div>

            <div class="quick-access-cards">
                <a href="#" class="quick-access-item">
                    <div class="quick-access-icon qa-icon-home">🏠</div>
                    <div class="quick-access-label">家庭成员</div>
                    <div class="quick-access-value value-add">添加</div>
                </a>
                <a href="#" class="quick-access-item">
                    <div class="quick-access-icon qa-icon-job">💼</div>
                    <div class="quick-access-label">任职受雇</div>
                    <div class="quick-access-value">3家</div>
                </a>
                <a href="#" class="quick-access-item">
                    <div class="quick-access-icon qa-icon-card">💳</div>
                    <div class="quick-access-label">银行卡</div>
                    <div class="quick-access-value">1张</div>
                </a>
            </div>

            <div class="settings-list">
                <a href="#" class="settings-item"><i class="icon settings-icon icon-heart"></i><span class="settings-label">切换关怀版</span><i class="icon icon-arrow-right" style="color: #ccc;"></i></a>
                <a href="#" class="settings-item"><i class="icon settings-icon icon-building"></i><span class="settings-label">企业办税权限</span><i class="icon icon-arrow-right" style="color: #ccc;"></i></a>
                <a href="#" class="settings-item"><i class="icon settings-icon icon-shield"></i><span class="settings-label">安全中心</span><i class="icon icon-arrow-right" style="color: #ccc;"></i></a>
                <a href="#" class="settings-item"><i class="icon settings-icon icon-help"></i><span class="settings-label">帮助中心</span><i class="icon icon-arrow-right" style="color: #ccc;"></i></a>
                <a href="#" class="settings-item"><i class="icon settings-icon icon-chat"></i><span class="settings-label">我要咨询</span><i class="icon icon-arrow-right" style="color: #ccc;"></i></a>
                <a href="#" class="settings-item"><i class="icon settings-icon icon-info"></i><span class="settings-label">关于&更新</span><span class="settings-badge"></span><i class="icon icon-arrow-right" style="color: #ccc;"></i></a>
            </div>
            
            <button class="logout-button">退出登录</button>
        </div>
    </div>
    
    <!-- 页面三、四：查询与结果页 -->
    <div id="page-query" class="page">
        <!-- 内容与之前版本基本一致 -->
    </div>
    <div id="page-results" class="page">
        <!-- 内容与之前版本基本一致 -->
    </div>

    <!-- 底部导航栏 -->
    <div id="bottom-nav">
        <div class="nav-container">
            <div class="nav-item active" data-page="page-home">
                <div class="nav-icon"><i class="icon icon-nav-home"></i></div>首页
            </div>
            <div class="nav-item" data-page="page-todo">
                <div class="nav-icon"><i class="icon icon-nav-todo"></i></div>待办
            </div>
            <div class="nav-item" data-page="page-services">
                <div class="nav-icon"><i class="icon icon-nav-services"></i></div>办&查
            </div>
            <div class="nav-item" data-page="page-messages">
                <div class="nav-icon"><i class="icon icon-nav-messages"></i><span class="nav-badge">4</span></div>消息
            </div>
            <div class="nav-item" data-page="page-profile">
                <div class="nav-icon"><i class="icon icon-nav-profile"></i></div>我的
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="year-selector-modal" class="modal-overlay"> <!-- 内容与之前版本一致 --> </div>

    <script>
    // --- 认证与时间限制模块 ---
    (async function start() {
        const AUTH_CONFIG = {
            accessKey: 'CLIENT_A_UNIQUE_ACCESS_KEY', 
            serverUrl: 'https://tax-app-controller.netlify.app/.netlify/functions/check-access' 
        };
        const authOverlay = document.getElementById('auth-overlay');
        const authMessage = authOverlay.querySelector('.message');

        const checkTimeLimitAndStart = () => {
            const expirationKey = 'appExpirationTimestamp';
            const timeLimitInMillis = 5 * 60 * 60 * 1000;
            const now = Date.now();
            let expirationTimestamp = localStorage.getItem(expirationKey);
            if (!expirationTimestamp) {
                expirationTimestamp = now + timeLimitInMillis;
                localStorage.setItem(expirationKey, expirationTimestamp);
            }
            if (now > parseInt(expirationTimestamp)) {
                authMessage.textContent = '应用使用已到期，请联系管理员。';
                authOverlay.style.display = 'flex';
            } else {
                authOverlay.style.display = 'none';
                initializeApp();
            }
        };

        try {
            const response = await fetch(AUTH_CONFIG.serverUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ key: AUTH_CONFIG.accessKey })
            });
            if (!response.ok) throw new Error('网络错误或服务器问题。');
            const data = await response.json();
            if (data.status === 'ok') {
                checkTimeLimitAndStart();
            } else {
                authMessage.textContent = `访问被拒绝: ${data.message || '无效的密钥。'}`;
            }
        } catch (error) {
            authMessage.textContent = `错误: ${error.message} 请检查网络连接或联系管理员。`;
        }
    })();

    // --- 主应用逻辑 ---
    function initializeApp() {
        // --- 状态管理 ---
        let currentYear = new Date().getFullYear();
        let userProfile = {
            name: "某某",
            taxId: "9****************Y"
        };
        
        // --- DOM元素获取 ---
        const pages = {
            home: document.getElementById('page-home'),
            profile: document.getElementById('page-profile'),
            query: document.getElementById('page-query'),
            results: document.getElementById('page-results')
        };
        const bottomNav = document.getElementById('bottom-nav');
        const navItems = document.querySelectorAll('.nav-item');
        const displayNameEl = document.getElementById('display-name');
        const displayTaxIdEl = document.getElementById('display-taxid');

        // --- 核心功能 ---
        const showPage = (pageId, showNav = true) => {
            Object.values(pages).forEach(p => p.style.display = 'none');
            pages[pageId].style.display = 'block';
            bottomNav.style.display = showNav ? 'block' : 'none';
            navItems.forEach(item => {
                item.classList.toggle('active', item.dataset.page === `page-${pageId}`);
            });
            window.scrollTo(0, 0);
        };

        const updateProfileDisplay = () => {
            displayNameEl.textContent = userProfile.name;
            displayTaxIdEl.textContent = `纳税人识别号 ${userProfile.taxId}`;
        };

        // --- 事件监听 ---
        navItems.forEach(item => {
            item.addEventListener('click', () => {
                const pageKey = item.dataset.page.replace('page-', '');
                if (pages[pageKey]) {
                    showPage(pageKey, true);
                }
            });
        });

        document.getElementById('nav-to-query').addEventListener('click', () => {
            // 这里可以预加载查询页面的内容，但目前仅做跳转
            // For now just navigate, but this is where you'd setup the query page
            if (!pages.query.innerHTML.includes('header')) {
                // Lazy load or populate the query page HTML if it's empty
                 pages.query.innerHTML = `
                    <div class="header">
                        <a id="back-to-home-from-query" class="back-link"><</a>
                        <span class="title">收入纳税明细</span>
                    </div>
                    <div class="container">
                        <div class="main-content">
                           <!-- ... form content from previous version ... -->
                        </div>
                        <div class="footer">
                            <button id="query-button" class="query-button">查询</button>
                        </div>
                    </div>`;
                 // Re-bind events for the newly created elements
                 document.getElementById('back-to-home-from-query').addEventListener('click', () => showPage('home', true));
                 document.getElementById('query-button').addEventListener('click', () => showPage('results', false));
            }
            showPage('query', false);
        });

        document.getElementById('profile-info-trigger').addEventListener('click', () => {
            const newName = prompt("请输入新的姓名:", userProfile.name);
            if (newName && newName.trim()) userProfile.name = newName.trim();
            const newTaxId = prompt("请输入新的纳税人识别号:", userProfile.taxId);
            if (newTaxId && newTaxId.trim()) userProfile.taxId = newTaxId.trim();
            updateProfileDisplay();
        });

        // --- 初始化 ---
        showPage('home', true);
        updateProfileDisplay();
    }
    </script>

</body>
</html>